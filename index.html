<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Malayalam Voice Studio</title><script src="https://cdn.tailwindcss.com"></script><script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script><script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script><script src="https://unpkg.com/@babel/standalone/babel.min.js"></script><style>.scrollbar-hide::-webkit-scrollbar{display:none}.custom-scroll::-webkit-scrollbar{width:4px}.custom-scroll::-webkit-scrollbar-track{background:transparent}.custom-scroll::-webkit-scrollbar-thumb{background-color:#cbd5e1;border-radius:10px}@keyframes spin{to{transform:rotate(360deg)}}.animate-spin-slow{animation:spin 1s linear infinite}</style></head><body class="bg-slate-50 text-slate-900 font-sans selection:bg-indigo-100 selection:text-indigo-900"><div id="root"></div><script type="text/babel">
const{useState,useRef,useMemo,useEffect,useCallback}=React;const VOICES=[{id:'anushka',name:'Anushka',gender:'Female',color:'from-pink-500 to-rose-500',desc:'Soft & Clear'},{id:'manisha',name:'Manisha',gender:'Female',color:'from-fuchsia-500 to-purple-600',desc:'Narrative'},{id:'vidya',name:'Vidya',gender:'Female',color:'from-violet-500 to-purple-500',desc:'Formal'},{id:'arya',name:'Arya',gender:'Female',color:'from-pink-400 to-orange-400',desc:'Energetic'},{id:'abhilash',name:'Abhilash',gender:'Male',color:'from-blue-500 to-cyan-500',desc:'Deep'},{id:'karun',name:'Karun',gender:'Male',color:'from-sky-500 to-blue-600',desc:'Casual'},{id:'hitesh',name:'Hitesh',gender:'Male',color:'from-teal-500 to-emerald-500',desc:'Authoritative'}],DEFAULT_SETTINGS={pace:1.0,pitch:0,loudness:1.0,sampleRate:16000};
const splitTextIntoChunks=(t,l=490)=>{const c=[],s=t.replace(/([.!?])\s*/g,"$1|").split("|");let cur="";s.forEach(sent=>{if((cur+sent).length>l){if(cur)c.push(cur.trim());if(sent.length>l){let w=sent.split(" ");cur="";w.forEach(wd=>{if((cur+" "+wd).length>l){c.push(cur.trim());cur=wd}else cur+=(cur?" ":"")+wd})}else cur=sent}else cur+=(cur?" ":"")+sent});if(cur)c.push(cur.trim());return c.filter(x=>x.length>0)};
const mergeWavBuffers=b=>{if(!b.length)return null;if(b.length===1)return b[0];const h=44,t=b.reduce((a,v)=>a+v.length-h,0)+h,r=new Uint8Array(t);r.set(b[0],0);let o=b[0].length;for(let i=1;i<b.length;i++){r.set(b[i].subarray(h),o);o+=b[i].length-h}const v=new DataView(r.buffer);v.setUint32(4,t-8,!0);v.setUint32(40,t-h,!0);return r};
const Icon=({name:n,size:s=20,className:c=""})=>{const i={play:<path d="M5 3l14 9-14 9V3z"/>,pause:<path d="M6 4h4v16H6zm8 0h4v16h-4z"/>,download:<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/>,volume:<path d="M11 5L6 9H2v6h4l5 4V5zM19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"/>,settings:<path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z M12 9a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"/>,loader:<path d="M21 12a9 9 0 1 1-6.219-8.56"/>,check:<polyline points="20 6 9 17 4 12"/>,sparkles:<path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/>,zap:<polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>,rotate:<g><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></g>,alert:<g><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></g>,checkCircle:<g><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></g>};return <svg xmlns="http://www.w3.org/2000/svg" width={s} height={s} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={c}>{i[n]}</svg>};
const Toast=({toast:t})=>t?<div className="fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50 transition-all duration-300 w-auto min-w-[300px] text-center pointer-events-none"><div className={`rounded-full px-6 py-3 shadow-2xl flex items-center justify-center gap-3 backdrop-blur-md bg-opacity-95 border ${t.type==='error'?'bg-red-50 text-red-900 border-red-200':'bg-slate-900 text-white border-slate-700'}`}><Icon name={t.type==='error'?'alert':'checkCircle'} size={20} className={t.type==='error'?'text-red-500':'text-green-400'}/><span className="text-sm font-semibold tracking-wide">{t.message}</span></div></div>:null;
const SettingsPanel=({settings:s,onChange:c,onReset:r})=><div className="bg-white border border-slate-200 rounded-2xl p-6 shadow-xl shadow-slate-200/50 space-y-6 animate-in slide-in-from-top-2"><div className="flex items-center justify-between"><h2 className="font-bold text-slate-800 flex items-center gap-2"><Icon name="settings" size={18}/> Audio Settings</h2><button onClick={r} className="text-xs flex items-center gap-1 text-slate-500 hover:text-indigo-600 px-2 py-1 rounded hover:bg-slate-50 transition-colors"><Icon name="rotate" size={12}/> Reset to Normal</button></div><div className="grid grid-cols-1 md:grid-cols-2 gap-8">{[{l:'Speed',v:s.pace,k:'pace',min:0.5,max:1.5,s:0.1,m:['0.5x','Normal','1.5x']},{l:'Pitch',v:s.pitch,k:'pitch',min:-1.0,max:1.0,s:0.1,m:['-1.0','Normal','+1.0']},{l:'Loudness',v:s.loudness,k:'loudness',min:0.5,max:1.5,s:0.1,m:['Soft','Normal','Loud']}].map(i=><div key={i.k}><label className="block text-xs font-bold uppercase text-slate-400 mb-2 tracking-wider flex justify-between"><span>{i.l}</span><span className="text-indigo-600">{i.v}</span></label><input type="range" min={i.min} max={i.max} step={i.s} value={i.v} onChange={e=>c(i.k,e.target.value)} className="w-full accent-indigo-600 h-2 bg-slate-100 rounded-lg appearance-none cursor-pointer"/><div className="flex justify-between text-[10px] text-slate-400 mt-2 font-medium">{i.m.map((x,idx)=><span key={idx} className={idx===1?'text-slate-600 text-center':'text-'+(idx===0?'left':'right')}>{x}</span>)}</div></div>)}<div><label className="block text-xs font-bold uppercase text-slate-400 mb-3 tracking-wider">Quality</label><div className="flex gap-2">{[8000,16000].map(r=><button key={r} onClick={()=>c('sampleRate',r)} className={`flex-1 py-2 px-3 rounded-lg text-xs font-bold border transition-all ${s.sampleRate===r?'bg-indigo-600 text-white border-indigo-600':'bg-white text-slate-500 border-slate-200'}`}>{r===8000?'8kHz':'16kHz'}</button>)}</div></div></div></div>;
const VoiceSelector=({currentVoice:c,genderFilter:g,setVoice:s,setFilter:f,voices:v})=><div className="lg:col-span-5 h-[500px] flex flex-col bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden order-1"><div className="p-4 border-b border-slate-100 bg-slate-50/50 shrink-0"><div className="flex items-center justify-between mb-4"><h2 className="font-bold text-slate-800 flex items-center gap-2"><Icon name="sparkles" size={16} className="text-indigo-500"/> Select Voice</h2></div><div className="flex gap-2 bg-slate-100 p-1 rounded-xl">{['Female','Male'].map(x=><button key={x} onClick={()=>f(x)} className={`flex-1 text-xs font-bold py-2 rounded-lg transition-all ${g===x?'bg-white text-indigo-600 shadow-sm':'text-slate-500 hover:text-slate-700'}`}>{x}</button>)}</div></div><div className="flex-1 overflow-y-auto p-3 custom-scroll"><div className="space-y-2">{v.map(i=>{const sel=c===i.id;return<button key={i.id} onClick={()=>s(i.id)} className={`w-full relative group text-left p-3 rounded-2xl border transition-all duration-200 flex items-center gap-3 ${sel?'bg-indigo-50 border-indigo-500 shadow-sm':'bg-white border-slate-100 hover:border-slate-300 hover:bg-slate-50/50'}`}><div className={`w-11 h-11 rounded-full bg-gradient-to-br ${i.color} flex items-center justify-center text-white font-bold text-sm shadow-sm shrink-0 ${sel?'scale-105 ring-2 ring-indigo-200 ring-offset-2':''}`}>{i.name[0]}</div><div className="flex-1 min-w-0"><div className="flex items-center gap-2"><div className="font-bold text-slate-800 text-sm truncate">{i.name}</div>{sel&&<Icon name="check" size={14} className="text-indigo-600" strokeWidth={3}/>}</div><div className="flex items-center gap-2 mt-0.5"><span className="text-[10px] text-slate-400">{i.desc}</span></div></div></button>})}</div></div></div>;
const App=()=>{const[text,setText]=useState("നമസ്കാരം, സുഖമാണോ? ഇതൊരു പുതിയ വോയിസ് ടെസ്റ്റ് ആണ്.");const[apiKey]=useState("sk_vvxe2t3j_2VyyNLnn9tA6Oxv798Hdlz7j");const[loading,setLoading]=useState(false);const[progress,setProgress]=useState("");const[audioUrl,setAudioUrl]=useState(null);const[audioBlob,setAudioBlob]=useState(null);const[showSettings,setShowSettings]=useState(false);const[toast,setToast]=useState(null);const[voice,setVoice]=useState("anushka");const[genderFilter,setGenderFilter]=useState("Female");const[settings,setSettings]=useState(DEFAULT_SETTINGS);const[isPlaying,setIsPlaying]=useState(false);const audioRef=useRef(null);
useEffect(()=>{if(toast){const t=setTimeout(()=>setToast(null),4000);return()=>clearTimeout(t)}},[toast]);const filteredVoices=useMemo(()=>VOICES.filter(v=>v.gender===genderFilter),[genderFilter]);const isSettingsModified=settings.pace!==1.0||settings.pitch!==0||settings.loudness!==1.0;const handleSettingChange=(k,v)=>setSettings(p=>({...p,[k]:parseFloat(v)}));const resetSettings=()=>{setSettings(DEFAULT_SETTINGS);setToast({type:'success',message:'Settings reset to normal'})};
const handleConvert=async()=>{if(!text.trim()){setToast({type:'error',message:'Please enter text first'});return}setLoading(!0);setToast(null);setAudioUrl(null);setAudioBlob(null);setProgress("Starting...");try{const chunks=splitTextIntoChunks(text);const b=[];for(let i=0;i<chunks.length;i++){setProgress(`Processing chunk ${i+1}/${chunks.length}`);const p={inputs:[chunks[i]],target_language_code:"ml-IN",speaker:voice,...settings,speech_sample_rate:parseInt(settings.sampleRate),enable_preprocessing:!0,model:"bulbul:v2"};const r=await fetch('https://api.sarvam.ai/text-to-speech',{method:'POST',headers:{'Content-Type':'application/json','api-subscription-key':apiKey.trim()},body:JSON.stringify(p)});if(!r.ok){try{const e=await r.json();throw new Error(e.message)}catch(e){throw new Error(`Error ${r.status}`)}}const d=await r.json();if(d.audios?.[0]){const c=atob(d.audios[0].replace(/\s/g,'')),n=new Array(c.length);for(let j=0;j<c.length;j++)n[j]=c.charCodeAt(j);b.push(new Uint8Array(n))}}setProgress("Merging...");const fb=mergeWavBuffers(b),fl=new Blob([fb],{type:'audio/wav'});setAudioBlob(fl);setAudioUrl(URL.createObjectURL(fl));setToast({type:'success',message:'Generated Successfully!'})}catch(e){console.error(e);setToast({type:'error',message:e.message||"Failed"})}finally{setLoading(!1);setProgress("")}};
const forceDownload=()=>{if(!audioBlob)return;try{const l=document.createElement('a');l.href=URL.createObjectURL(new Blob([audioBlob],{type:'application/octet-stream'}));l.download=`malayalam_${voice}_${Date.now()}.wav`;l.style.display='none';document.body.appendChild(l);l.click();setToast({type:'success',message:'Download Started'});setTimeout(()=>{document.body.removeChild(l)},2000)}catch(e){setToast({type:'error',message:'Download failed'})}};
return(<div className="min-h-screen bg-slate-50 text-slate-900 font-sans pb-24"><nav className="bg-white border-b border-slate-200 sticky top-0 z-30 shadow-sm backdrop-blur-md bg-opacity-95"><div className="max-w-6xl mx-auto px-4 h-16 flex items-center justify-between"><div className="flex items-center gap-2.5"><div className="bg-gradient-to-br from-indigo-500 to-purple-600 text-white p-2 rounded-xl shadow-lg shadow-indigo-200"><Icon name="zap" className="text-white"/></div><div><h1 className="font-bold text-lg tracking-tight text-slate-900 leading-none">Malayalam<span className="text-indigo-600">AI</span></h1><div className="flex items-center gap-1.5 mt-0.5"><span className="text-[10px] text-slate-500 font-medium tracking-wide uppercase">Voice Studio</span></div></div></div><button onClick={()=>setShowSettings(!showSettings)} className={`p-2 rounded-full transition-all ${showSettings?'bg-indigo-50 text-indigo-600 rotate-90':'hover:bg-slate-100 text-slate-400'}`}><Icon name="settings"/></button></div></nav><main className="max-w-6xl mx-auto px-4 py-6 space-y-6">{showSettings&&<SettingsPanel settings={settings} onChange={handleSettingChange} onReset={resetSettings}/>}<div className="grid grid-cols-1 lg:grid-cols-12 gap-6"><VoiceSelector currentVoice={voice} genderFilter={genderFilter} setVoice={setVoice} setFilter={setGenderFilter} voices={filteredVoices}/><div className="lg:col-span-7 space-y-6 order-2"><div className="bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden group focus-within:ring-2 focus-within:ring-indigo-500/20 transition-all flex flex-col h-[400px]"><div className="bg-slate-50 border-b border-slate-100 px-4 py-3 flex justify-between items-center shrink-0"><div className="flex items-center gap-2 text-slate-500"><span className="text-xs font-bold uppercase tracking-wider">Input Text</span></div><div className="flex gap-2">{isSettingsModified&&(<span className="text-[10px] bg-indigo-50 text-indigo-600 px-2 py-1 rounded-full flex items-center gap-1"><Icon name="settings" size={10}/> Modified</span>)}<button onClick={()=>setText("")} className="text-xs font-medium text-slate-400 hover:text-indigo-600 px-2 py-1 rounded hover:bg-white transition-colors">Clear</button></div></div><textarea value={text} onChange={(e)=>setText(e.target.value)} className="w-full flex-1 p-6 text-xl text-slate-800 bg-white resize-none focus:outline-none placeholder:text-slate-300 leading-relaxed font-malayalam" placeholder="Type Malayalam text here... (Unlimited)" dir="auto" spellCheck="false"/><div className="bg-white px-6 pb-4 flex justify-end shrink-0"><span className="text-xs font-medium text-slate-400">{text.length} chars (No Limit)</span></div></div><div className="bg-white p-4 rounded-2xl border border-slate-200 shadow-sm flex flex-col sm:flex-row items-center gap-4"><div className={`flex-1 w-full flex items-center gap-4 bg-slate-50 rounded-xl p-2 pr-4 border border-slate-100 transition-all duration-500 ${audioUrl?'opacity-100 translate-y-0':'opacity-50 grayscale translate-y-1'}`}><button onClick={()=>{if(audioRef.current)isPlaying?audioRef.current.pause():audioRef.current.play();setIsPlaying(!isPlaying)}} disabled={!audioUrl} className="w-12 h-12 flex items-center justify-center bg-white text-slate-800 rounded-full shadow-sm border border-slate-200 hover:border-indigo-300 hover:text-indigo-600 transition-all active:scale-90 shrink-0">{isPlaying?<Icon name="pause"/>:<Icon name="play"/>}</button><div className="flex-1 min-w-0 h-10 flex flex-col justify-center gap-1.5"><div className="flex items-end gap-0.5 h-full w-full opacity-60 overflow-hidden">{[...Array(20)].map((_,i)=>(<div key={i} className={`w-1 rounded-full transition-all duration-300 ${isPlaying?'bg-indigo-500 animate-spin-slow':'bg-slate-300'}`} style={{height:isPlaying?'60%':'20%',animationDelay:`${i*0.05}s`}}/>))}</div></div><div className="h-8 w-px bg-slate-200 mx-1 shrink-0"></div><button onClick={forceDownload} disabled={!audioUrl} className="flex items-center gap-2 px-4 py-2 bg-indigo-50 border border-indigo-100 rounded-lg text-indigo-700 hover:bg-indigo-100 hover:border-indigo-200 transition-colors shrink-0 shadow-sm active:scale-95 transform"><Icon name="download" size={18}/><span className="hidden sm:inline text-xs font-bold uppercase tracking-wide">Download</span></button></div><button onClick={handleConvert} disabled={loading} className={`w-full sm:w-auto h-16 px-8 rounded-2xl font-bold text-white shadow-xl shadow-indigo-200 flex items-center justify-center gap-3 transition-all transform hover:-translate-y-1 active:translate-y-0 ${loading?'bg-slate-800 cursor-not-allowed shadow-none opacity-80':'bg-slate-900 hover:bg-black'}`}>{loading?(<><Icon name="loader" size={20} className="animate-spin-slow"/><span className="text-sm font-mono text-center leading-tight">{progress||"Processing"}</span></>):(<><span className="text-lg">Generate</span><div className="bg-indigo-600 p-1.5 rounded-lg"><Icon name="volume" size={16}/></div></>)}</button></div></div></div></main>{toast&&<div className="fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50 animate-in slide-in-from-bottom-5 fade-in duration-300 w-auto min-w-[320px] text-center"><div className={`rounded-full px-6 py-3 shadow-2xl flex items-center justify-center gap-3 backdrop-blur-md bg-opacity-95 border ${toast.type==='error'?'bg-red-50 text-red-900 border-red-200':'bg-slate-900 text-white border-slate-700'}`}>{toast.type==='error'?<Icon name="alert" size={20} className="text-red-500"/>:<Icon name="checkCircle" size={20} className="text-green-400"/>}<span className="text-sm font-semibold tracking-wide">{toast.message}</span></div></div>}<audio ref={audioRef} src={audioUrl||""} onEnded={()=>setIsPlaying(!1)} onError={()=>{setIsPlaying(!1);if(audioUrl)console.error("Audio playback error")}}/ ></div>);};
const root=ReactDOM.createRoot(document.getElementById('root'));root.render(<App/>);
</script></body></html>


